////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//!
//!  \file      feedback.c
//!  \brief
//!  \details
//!
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Includes ------------------------------------------------------------------------------------------------------------

#include "feedback.h"
#include "ldriver.h"

// Defines -------------------------------------------------------------------------------------------------------------

// Typedefs ------------------------------------------------------------------------------------------------------------

// Local (static) & extern variables -----------------------------------------------------------------------------------

// Local (static) function prototypes ----------------------------------------------------------------------------------

static uint8_t mmToLedPos(uint8_t mm);

// Global function definitions -----------------------------------------------------------------------------------------

void ledFeedback(LINE* line)
{
    uint32_t ledval = 0, i;

    for (i = 0; i < line->cnt; i++)
    {
        ledval |= mmToLedPos(line->lines[i]);
        ledval |= mmToLedPos(line->lines[i] + 1);
    }

    writeLed(ledval);
}

// Local (static) function definitions ---------------------------------------------------------------------------------

static uint8_t mmToLedPos(uint8_t mm)
{
    return (uint8_t)((mm - MID_IR_POS_MM) / IR_DIST_MM + 16);
}
