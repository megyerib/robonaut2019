////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//!
//!  \file      sensor.c
//!  \brief
//!  \details
//!
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Includes ------------------------------------------------------------------------------------------------------------

#include "../../1_App/Inc/eval.h"
#include "../../1_App/Inc/feedback.h"
#include "../../1_App/Inc/measure.h"
#include "../../2_BSP/Inc/ldriver.h"
#include "../../2_BSP/Inc/mux.h"

// Defines -------------------------------------------------------------------------------------------------------------

// Typedefs ------------------------------------------------------------------------------------------------------------

// Local (static) & extern variables -----------------------------------------------------------------------------------

// Local (static) function prototypes ----------------------------------------------------------------------------------

// Global function definitions -----------------------------------------------------------------------------------------

// Local (static) function definitions ---------------------------------------------------------------------------------

void startSensor()
{
    uint32_t measVals[32];
    LINE_SENSOR_OUT line;

    // Init
    initLDriver();
    initMux();

    enableIr();
    enableLed();

    // Loop
    while (1)
    {
        measure(measVals);
        line = getLine(measVals);
        ledFeedback(&line);
    }
}
